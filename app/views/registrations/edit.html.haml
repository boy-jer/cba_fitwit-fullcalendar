/ REVIEW: Should this view be splitted up in partials?
- title t("edit_resource_named", :resource => resource_name.to_s.humanize,:name => @user.name||'new')
.clear

- content_for :resource_actions do
  = ui_button 'expand', t(:list_registrations), registrations_path
  - if current_user && @user == current_user # It's you
    = ui_button( 'zoom', t(:show_profile), user_path(@user))
.field
  = label_tag :role, t(:role)
  = @user.role.to_s
  %br/
  %br/
= form_for(resource, :as => resource_name, :url => registration_path(resource_name), |
  :html => { :method => :put, :multipart => true }) do |f|                           |
  = devise_error_messages!
  .field
    = f.label :name
    = f.text_field :name
  .field
    = f.label :email
    = f.text_field :email
  .field
    = f.label :avatar,t(:upload_avatar)
    - if @user.avatar
      = image_tag @user.avatar_url(:thumb)
    = f.file_field :avatar
  .field
    = f.label :clear_avatar, t(:or_clear_avatar)
    = f.check_box :clear_avatar
    = t(:clear_avatar)
  .field
    = f.label :use_gravatar
    = f.check_box :use_gravatar
    = link_button 'Gravatar?', "button link tiny", "http://gravatar.com", :target => :blank
    %small= @user.email.downcase
  / PASSWORD FIELDS IF NO AUTH-SERVICE IS USED
  - if @user.authentications.empty?
    %h2 Password
    .field
      = f.label :password
      = f.password_field :password
      %address
        %i (leave blank if you don't want to change it)
    .field
      = f.label :password_confirmation
      = f.password_field :password_confirmation
  .field
    #gis_location-preview
      \Â 
    = f.label :gis_location_token, t(:gis_location_label)
    = f.text_field :gis_location_token
  .field
    = f.label :search_by_address, t(:search_by_address)
    = text_field_tag "address"
  - if @user.authentications.empty?
    .field
      = f.label :current_password
      = f.password_field :current_password
      %address
        %i (we need your current password to confirm your changes)
  .field
    = f.label :submit
    = f.submit "Update", :class => "medium-btn glass-btn"
  %h2= t(:or_user_omni_auth)
  = render '/authentications/authentications'
  %h3= t(:your_associated_accounts)
  - if @user.authentications.empty?
    = t(:you_have_no_authentications_yet)
  - else
    - for a in @user.authentications
      = render(:partial => '/authentications/authentication', :locals => {:authentication => a})
    .clear
    .field
      = f.label :edit
      = link_button( t(:edit_authentication_providers),"button edit small", authentications_path(@user) )
  .clear
.field
  = label_tag :unhappy?
  = link_to t(:cancel_my_account), registration_path(resource_name), |
    :confirm => t(:sure?), :method => :delete,                       |
    :class => "button delete small"                                  |
- content_for :resource_actions do
  = ui_button( 'back', t(:back), :back)